<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Детали заявки - CRM System</title>
  <th:block th:replace="~{fragments/header :: head}"></th:block>
</head>
<body>
<nav th:replace="~{fragments/header :: navbar}"></nav>

<main class="container my-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Детали заявки #<span th:text="${request.id}">1</span></h1>
    <div>
      <a th:href="@{/requests/edit/{id}(id=${request.id})}" class="btn btn-warning">Изменить</a>
      <a href="/requests" class="btn btn-secondary">Назад к списку</a>
    </div>
  </div>

  <div class="card">
    <div class="card-body">
      <div class="row mb-3">
        <div class="col-md-3 fw-bold">Статус:</div>
        <div class="col-md-9">
          <span th:if="${request.handled}" class="badge bg-success fs-6">Обработана</span>
          <span th:unless="${request.handled}" class="badge bg-warning text-dark fs-6">Ожидает обработки</span>
        </div>
      </div>

      <div class="row mb-3">
        <div class="col-md-3 fw-bold">Имя пользователя:</div>
        <div class="col-md-9" th:text="${request.userName}">Иван Иванов</div>
      </div>

      <div class="row mb-3">
        <div class="col-md-3 fw-bold">Название курса:</div>
        <div class="col-md-9" th:text="${request.courseName}">Java Spring Boot</div>
      </div>

      <div class="row mb-3">
        <div class="col-md-3 fw-bold">Телефон:</div>
        <div class="col-md-9" th:text="${request.phone}">+7 999 123-45-67</div>
      </div>

      <div class="row mb-3">
        <div class="col-md-3 fw-bold">Комментарий:</div>
        <div class="col-md-9">
          <p th:if="${request.commentary != null and !request.commentary.isEmpty()}"
             th:text="${request.commentary}">Комментарий к заявке</p>
          <p th:if="${request.commentary == null or request.commentary.isEmpty()}"
             class="text-muted fst-italic">Комментарий отсутствует</p>
        </div>
      </div>
    </div>
  </div>

  <div class="mt-3">
    <a th:href="@{/requests/delete/{id}(id=${request.id})}"
       class="btn btn-danger"
       onclick="return confirm('Вы уверены, что хотите удалить эту заявку?')">Удалить заявку</a>
  </div>
</main>

<footer th:replace="~{fragments/header :: footer}"></footer>
<div th:replace="~{fragments/header :: scripts}"></div>
</body>
</html>
